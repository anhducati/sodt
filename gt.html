<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>V√≤ng Quay May M·∫Øn - Chung Anh</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #1e293b, #020617);
      color: #e5e7eb;
    }

    .wheel-wrapper {
      text-align: center;
    }

    .wheel-container {
      position: relative;
      width: 420px;
      height: 420px;
      margin: 0 auto 24px auto;
    }

    /* V√≤ng quay */
    #wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 8px solid #e5e7eb;
      box-shadow: 0 0 30px rgba(15,23,42,0.8);
      background: #020617;
      transition: transform 4s cubic-bezier(0.15, 0.75, 0.25, 1);
    }

    /* M≈©i t√™n tr√™n c√πng */
    .pointer {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid #facc15;
      filter: drop-shadow(0 0 8px #fbbf24);
    }

    .center-circle {
      position: absolute;
      width: 70px;
      height: 70px;
      background: #facc15;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #1f2937;
      font-weight: 700;
      font-size: 18px;
      box-shadow: 0 0 18px rgba(250, 204, 21, 0.8);
      text-align: center;
      padding: 4px;
      pointer-events: none;
    }

    button#spinBtn {
      padding: 10px 24px;
      border-radius: 999px;
      border: none;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: white;
      box-shadow: 0 10px 20px rgba(34,197,94,0.35);
      transition: transform 0.15s, box-shadow 0.15s, filter 0.15s;
    }

    button#spinBtn:hover:enabled {
      transform: translateY(-1px);
      filter: brightness(1.03);
      box-shadow: 0 14px 30px rgba(34,197,94,0.45);
    }

    button#spinBtn:active:enabled {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 6px 14px rgba(34,197,94,0.3);
    }

    button#spinBtn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
    }

    .result {
      margin-top: 16px;
      font-size: 18px;
      min-height: 26px;
    }

    .result span {
      font-weight: 700;
      color: #fbbf24;
    }

    .title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .subtitle {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 20px;
    }

    @media (max-width: 480px) {
      .wheel-container {
        width: 320px;
        height: 320px;
      }
    }
  </style>
</head>
<body>
  <div class="wheel-wrapper">
    <div class="title">V√≤ng Quay May M·∫Øn</div>
    <div class="subtitle">Nh·∫•n QUAY &amp; ch·ªù k·∫øt qu·∫£‚Ä¶</div>

    <div class="wheel-container">
      <div class="pointer"></div>
      <canvas id="wheel"></canvas>
      <div class="center-circle">QUAY</div>
    </div>

    <button id="spinBtn">üé∞ QUAY NGAY</button>
    <div class="result" id="resultText"></div>
  </div>

  <script>
    // ====== C·∫§U H√åNH GI·∫¢I TH∆Ø·ªûNG ======
    // üëâ S·ª≠a m·∫£ng n√†y theo √Ω b·∫°n
    const prizes = [
      "Gi·∫£m 50k",
      "Gi·∫£m 100k",
      "Qu√† T·∫∑ng √Åo M∆∞a",
      "B√¨nh D·∫ßu Mi·ªÖn Ph√≠",
      "R·ª≠a Xe Free",
      "Phi·∫øu B·ªëc ThƒÉm",
      "Th√™m 1 L·∫ßn Quay",
      "Ch√∫c May M·∫Øn L·∫ßn Sau"
    ];

    const wheelCanvas = document.getElementById("wheel");
    const ctx = wheelCanvas.getContext("2d");
    const spinBtn = document.getElementById("spinBtn");
    const resultText = document.getElementById("resultText");
    const centerCircle = document.querySelector(".center-circle");
    const wheelElement = document.getElementById("wheel");

    // K√≠ch th∆∞·ªõc canvas = k√≠ch th∆∞·ªõc khung
    function resizeCanvas() {
      const parent = wheelCanvas.parentElement;
      const size = parent.clientWidth;
      wheelCanvas.width = size;
      wheelCanvas.height = size;
      drawWheel();
    }

    window.addEventListener("resize", resizeCanvas);

    // V·∫Ω v√≤ng quay
    function drawWheel() {
      const size = wheelCanvas.width;
      const radius = size / 2;
      const cx = radius;
      const cy = radius;
      const count = prizes.length;
      const step = (2 * Math.PI) / count;

      ctx.clearRect(0, 0, size, size);

      for (let i = 0; i < count; i++) {
        const start = i * step;
        const end = start + step;

        // M√†u xen k·∫Ω
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.arc(cx, cy, radius - 4, start, end);
        ctx.closePath();
        ctx.fillStyle = i % 2 === 0 ? "#0ea5e9" : "#6366f1";
        ctx.fill();
        ctx.strokeStyle = "#020617";
        ctx.lineWidth = 2;
        ctx.stroke();

        // Text
        ctx.save();
        ctx.translate(cx, cy);
        const angle = start + step / 2;
        ctx.rotate(angle);
        ctx.textAlign = "right";
        ctx.fillStyle = "#f9fafb";
        ctx.font = `${Math.max(12, radius / 12)}px system-ui`;
        ctx.fillText(prizes[i], radius - 20, 4);
        ctx.restore();
      }
    }

    // Animation quay
    let isSpinning = false;
    let totalRotation = 0; // t·ªïng ƒë·ªô ƒë√£ quay (deg)

    function spin() {
      if (isSpinning) return;
      isSpinning = true;
      spinBtn.disabled = true;
      resultText.textContent = "ƒêang quay...";
      centerCircle.textContent = "ƒêANG QUAY";
      centerCircle.style.fontSize = "14px";

      // S·ªë v√≤ng quay (5‚Äì8 v√≤ng) + g√≥c ng·∫´u nhi√™n
      const spins = 5 + Math.floor(Math.random() * 4); // 5,6,7,8
      const extraDegrees = Math.random() * 360;
      const spinDeg = spins * 360 + extraDegrees;

      totalRotation += spinDeg;

      wheelElement.style.transition = "transform 4s cubic-bezier(0.15, 0.75, 0.25, 1)";
      wheelElement.style.transform = `rotate(${totalRotation}deg)`;
    }

    // T√≠nh gi·∫£i tr√∫ng sau khi quay xong
    function handleSpinEnd() {
      // Chu·∫©n h√≥a g√≥c v·ªÅ [0, 360)
      const normalized = ((totalRotation % 360) + 360) % 360;

      const count = prizes.length;
      const stepDeg = 360 / count;

      // G√≥c m≈©i t√™n l√† 90¬∞ (tr√™n c√πng)
      // Khi quay, g√≥c tr√∫ng = 90¬∞ - g√≥c quay
      let pickedAngleDeg = 90 - normalized;
      pickedAngleDeg = ((pickedAngleDeg % 360) + 360) % 360;

      const index = Math.floor(pickedAngleDeg / stepDeg);
      const prize = prizes[index];

      // Hi·ªán k·∫øt qu·∫£
      resultText.innerHTML = `K·∫øt qu·∫£: <span>${prize}</span>`;

      // ƒê·ªïi ch·ªØ "QUAY" ·ªü gi·ªØa th√†nh t√™n gi·∫£i
      centerCircle.textContent = prize;
      centerCircle.style.fontSize = prize.length > 14 ? "12px" : "16px";

      isSpinning = false;
      spinBtn.disabled = false;
    }

    spinBtn.addEventListener("click", spin);

    // L·∫Øng nghe khi animation k·∫øt th√∫c (ch·ªâ 1 listener)
    wheelElement.addEventListener("transitionend", handleSpinEnd);

    // Kh·ªüi t·∫°o
    resizeCanvas();
  </script>
</body>
</html>